# ğŸ” SonarCloud Quality Monitoring

Guide for using SonarCloud to monitor code quality and maintainability.

## Overview

This project uses **SonarCloud** for continuous code quality analysis:

- **Project:**
  [syafiqhadzir.github.io](https://sonarcloud.io/project/overview?id=syafiqhadzir.github.io)
- **Organization:** syafiqhadzir
- **Quality Gate:** Sonar Way (Strict)

---

## ğŸ“Š Quality Metrics

### Code Quality

| Metric          | Target | Description               |
| --------------- | ------ | ------------------------- |
| Reliability     | A      | No bugs                   |
| Security        | A      | No vulnerabilities        |
| Maintainability | A      | Technical debt ratio < 5% |
| Coverage        | â‰¥ 80%  | Unit test coverage        |
| Duplications    | < 3%   | Code duplication          |

### Quality Gate Conditions

| Condition           | Threshold |
| ------------------- | --------- |
| New Bugs            | 0         |
| New Vulnerabilities | 0         |
| New Code Smells     | 0         |
| New Coverage        | â‰¥ 80%     |
| New Duplications    | < 3%      |

---

## ğŸš€ Running Analysis

### Local Analysis

```bash
# Prepare reports (coverage + lint)
npm run sonar:prepare

# Run SonarScanner
npm run sonar
```

### Required Files

The analysis requires these generated files:

| File                    | Generated By                 | Purpose          |
| ----------------------- | ---------------------------- | ---------------- |
| `coverage/lcov.info`    | `npm run test:unit:coverage` | Test coverage    |
| `eslint-report.json`    | `npm run lint:js:report`     | ESLint issues    |
| `stylelint-report.json` | `npm run lint:css:report`    | Stylelint issues |

### CI Integration

SonarCloud analysis runs automatically:

- **On PRs:** Analyzes new code only
- **On main:** Full repository analysis
- **Nightly:** Deep analysis with all metrics

---

## âš™ï¸ Configuration

### sonar-project.properties

```properties
sonar.projectKey=syafiqhadzir.github.io
sonar.organization=syafiqhadzir

# Source configuration
sonar.sources=src
sonar.tests=test
sonar.exclusions=**/node_modules/**,**/dist/**,**/_site/**

# TypeScript configuration
sonar.typescript.lcov.reportPaths=coverage/lcov.info
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# ESLint integration
sonar.eslint.reportPaths=eslint-report.json

# Test configuration
sonar.coverage.exclusions=**/*.test.ts,**/*.spec.ts
```

---

## ğŸ“ˆ Interpreting Results

### Dashboard Overview

1. **Quality Gate:** Pass/Fail status
2. **New Code:** Metrics for recent changes
3. **Overall Code:** Full repository metrics

### Issue Types

| Type             | Severity       | Description                 |
| ---------------- | -------------- | --------------------------- |
| Bug              | Critical/Major | Likely defects              |
| Vulnerability    | Critical/Major | Security risks              |
| Code Smell       | Infoâ†’Critical  | Maintainability issues      |
| Security Hotspot | Review needed  | Potential security concerns |

### Issue Resolution

1. **Review** the issue in SonarCloud UI
2. **Understand** the problem and recommendation
3. **Fix** the issue in code
4. **Verify** fix with local analysis
5. **Push** changes to trigger re-analysis

---

## ğŸ”§ Common Issues

### Coverage Not Detected

**Problem:** Coverage shows 0% despite tests

**Solution:**

```bash
# Ensure coverage runs before sonar
npm run test:unit:coverage
npm run sonar
```

### ESLint Issues Not Imported

**Problem:** ESLint findings not in SonarCloud

**Solution:**

```bash
# Generate ESLint report first
npm run lint:js:report
npm run sonar
```

### Analysis Fails

**Problem:** SonarScanner returns error

**Solutions:**

1. Check `SONAR_TOKEN` is set
2. Verify `sonar-project.properties` syntax
3. Ensure all report files exist
4. Check organization/project key match

---

## ğŸ¯ Best Practices

### For New Code

1. **Zero new issues:** Don't introduce bugs
2. **Maintain coverage:** Test new code
3. **Follow patterns:** Use existing code style

### For Legacy Code

1. **Clean as you go:** Fix issues when touching files
2. **Prioritize:** Focus on critical/major issues
3. **Document exceptions:** If can't fix, document why

### For Code Reviews

1. **Check Quality Gate:** Must pass before merge
2. **Review new issues:** Address before approval
3. **Verify coverage:** New code should be tested

---

## ğŸ“Š Badges

Add to README for visibility:

```markdown
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=syafiqhadzir.github.io&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=syafiqhadzir.github.io)

[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=syafiqhadzir.github.io&metric=coverage)](https://sonarcloud.io/summary/new_code?id=syafiqhadzir.github.io)

[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=syafiqhadzir.github.io&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=syafiqhadzir.github.io)
```

---

## ğŸ”— Resources

- [SonarCloud Documentation](https://docs.sonarcloud.io/)
- [Quality Profiles](https://sonarcloud.io/organizations/syafiqhadzir/quality_profiles)
- [Analysis History](https://sonarcloud.io/project/activity?id=syafiqhadzir.github.io)

---

_Last updated: 2026-01-07_
