# SonarCloud Configuration for Google AMP Portfolio
# Eleventy + TypeScript + SCSS Architecture

# Project Identification (SonarCloud format)
sonar.projectKey=syafiqhadzir_syafiqhadzir.github.io
sonar.organization=syafiqhadzir
sonar.host.url=https://sonarcloud.io

# Project Info
sonar.projectName=Syafiq Hadzir Portfolio
sonar.projectVersion=2.0.0

# Source Configuration
# Main source directories
sonar.sources=src,_includes

# Test directories (analyzed separately for reliability, not maintainability)
sonar.tests=test

# Source encoding
sonar.sourceEncoding=UTF-8

# Language-Specific Settings
# TypeScript/JavaScript Coverage (LCOV from Vitest)
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# SCSS files
sonar.css.stylelint.reportPaths=stylelint-report.json

# HTML Analysis - Only analyze Nunjucks templates
sonar.html.file.suffixes=.njk,.html

# Exclusions (Expert-Level Regex)
# Exclude from analysis entirely
sonar.exclusions=\
  _site/**,\
  node_modules/**,\
  coverage/**,\
  cypress/reports/**,\
  cypress/screenshots/**,\
  cypress/videos/**,\
  dist/**,\
  .cache/**,\
  **/*.min.js,\
  **/*.min.css,\
  **/vendor/**

# Exclude test files from coverage calculation
sonar.coverage.exclusions=\
  test/**,\
  **/*.test.ts,\
  **/*.spec.ts,\
  cypress/**,\
  vitest.config.ts,\
  eleventy.config.js

# Exclude from duplication detection (AMP boilerplate is intentionally duplicated)
sonar.cpd.exclusions=\
  _includes/layouts/**,\
  **/*.njk

# Issue Ignore Rules (AMP-Specific False Positives)
# Multicriteria for ignoring false positives
sonar.issue.ignore.multicriteria=ampCustomStyle,ampBoilerplate,ampBindSyntax

# Ignore inline CSS warnings for AMP files (amp-custom is required by spec)
sonar.issue.ignore.multicriteria.ampCustomStyle.ruleKey=Web:InlineStyleCheck
sonar.issue.ignore.multicriteria.ampCustomStyle.resourceKey=**/*.html

# Ignore duplicate code in AMP boilerplate (required by AMP spec)
sonar.issue.ignore.multicriteria.ampBoilerplate.ruleKey=common-web:DuplicatedBlocks
sonar.issue.ignore.multicriteria.ampBoilerplate.resourceKey=**/*.njk

# Ignore AMP-bind syntax [attribute] patterns (valid AMP, not invalid HTML)
sonar.issue.ignore.multicriteria.ampBindSyntax.ruleKey=Web:S1827
sonar.issue.ignore.multicriteria.ampBindSyntax.resourceKey=**/*.html

# Quality Gate Configuration
# Wait for quality gate result in CI (blocks deployment if fails)
sonar.qualitygate.wait=true
sonar.qualitygate.timeout=300

# Analysis Parameters
# Cognitive Complexity threshold (aligned with ESLint config)
sonar.javascript.maxCognitiveComplexity=15

# Enable additional analyzers
sonar.javascript.node.maxspace=4096

# SCM provider
sonar.scm.provider=git
sonar.scm.forceReloadAll=false

# External Issue Reports
# ESLint report (generated in CI)
sonar.eslint.reportPaths=eslint-report.json

# Logging (set to INFO for production)
sonar.verbose=false
sonar.log.level=INFO
