// ============================================================================
// SASS MIXINS
// Reusable patterns for responsive design, typography, and accessibility
// ============================================================================

@use 'sass:map';

// ============================================================================
// BREAKPOINT MIXINS
// Mobile-first responsive design
// ============================================================================

/// Breakpoint map

$breakpoints: (
    'xs': 320px,
    'sm': 480px,
    'md': 600px,
    'lg': 768px,
    'xl': 1024px,
    'xxl': 1280px,
);

/// Media query for minimum width (mobile-first)
/// @param {String} $breakpoint - Breakpoint name from map
@mixin media-up($breakpoint) {
    @if map.has-key($breakpoints, $breakpoint) {
        @media (width >=#{map.get($breakpoints, $breakpoint)}) {
            @content;
        }
    } @else {
        @warn "Unknown breakpoint: #{$breakpoint}";
    }
}

/// Media query for maximum width
/// @param {String} $breakpoint - Breakpoint name from map
@mixin media-down($breakpoint) {
    @if map.has-key($breakpoints, $breakpoint) {
        @media (width < #{map.get($breakpoints, $breakpoint)}) {
            @content;
        }
    } @else {
        @warn "Unknown breakpoint: #{$breakpoint}";
    }
}

/// Media query between two breakpoints
/// @param {String} $lower - Lower breakpoint name
/// @param {String} $upper - Upper breakpoint name
@mixin media-between($lower, $upper) {
    @if map.has-key($breakpoints, $lower) and map.has-key($breakpoints, $upper) {
        @media (width >=#{map.get($breakpoints, $lower)}) and (width < #{map.get($breakpoints, $upper)}) {
            @content;
        }
    } @else {
        @warn "Unknown breakpoint(s): #{$lower}, #{$upper}";
    }
}

// ============================================================================
// ACCESSIBILITY MIXINS
// ============================================================================

/// Visually hide element but keep accessible to screen readers
@mixin visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    overflow: hidden;
    white-space: nowrap;
    border: 0;
    // stylelint-disable-next-line property-no-deprecated -- Legacy browser support
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
}

/// Remove visually hidden styles
@mixin visually-hidden-reset {
    position: static;
    width: auto;
    height: auto;
    margin: 0;
    overflow: visible;
    white-space: normal;
    // stylelint-disable-next-line property-no-deprecated -- Legacy browser support
    clip: auto;
    clip-path: none;
}

/// Focus ring for keyboard navigation
/// @param {Color} $color [currentcolor] - Focus ring color
/// @param {Number} $width [3px] - Focus ring width
/// @param {Number} $offset [2px] - Focus ring offset
@mixin focus-ring($color: currentcolor, $width: 3px, $offset: 2px) {
    outline: $width solid $color;
    outline-offset: $offset;
}

/// Focus visible only (keyboard, not mouse)
@mixin focus-visible-only {
    &:focus {
        outline: none;
    }

    &:focus-visible {
        @content;
    }
}

/// Reduced motion preference
@mixin reduced-motion {
    @media (prefers-reduced-motion: reduce) {
        @content;
    }
}

/// High contrast mode
@mixin high-contrast {
    @media (prefers-contrast: more) {
        @content;
    }
}

// ============================================================================
// TYPOGRAPHY MIXINS
// ============================================================================

/// Truncate text with ellipsis
/// @param {Number} $lines [1] - Number of lines before truncation
@mixin truncate($lines: 1) {
    @if $lines == 1 {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    } @else {
        display: -webkit-box;
        overflow: hidden;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: $lines;
    }
}

/// Reset list styles
@mixin list-reset {
    margin: 0;
    padding: 0;
    list-style: none;
}

/// Reset button styles
@mixin button-reset {
    padding: 0;
    font: inherit;
    color: inherit;
    background: none;
    border: none;
    cursor: pointer;
    appearance: none;
}

// ============================================================================
// LAYOUT MIXINS
// ============================================================================

/// Flexbox centering
@mixin flex-center {
    display: flex;
    justify-content: center;
    align-items: center;
}

/// Flexbox with gap
/// @param {Number} $gap - Gap between items
/// @param {String} $direction [row] - Flex direction
@mixin flex-gap($gap, $direction: row) {
    display: flex;
    flex-direction: $direction;
    gap: $gap;
}

/// CSS Grid with auto-fit columns
/// @param {Number} $min-width - Minimum column width
/// @param {Number} $gap [1rem] - Gap between items
@mixin grid-auto-fit($min-width, $gap: 1rem) {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax($min-width, 1fr));
    gap: $gap;
}

/// Aspect ratio container
/// @param {Number} $width - Width ratio
/// @param {Number} $height - Height ratio
@mixin aspect-ratio($width, $height) {
    aspect-ratio: #{$width} / #{$height};
}

// ============================================================================
// THEME MIXINS
// ============================================================================

/// Apply styles only in dark mode
@mixin dark-mode {
    [data-theme='dark'] & {
        @content;
    }

    @media (prefers-color-scheme: dark) {
        :root:not([data-theme='light']) & {
            @content;
        }
    }
}

/// Apply styles only in light mode
@mixin light-mode {
    [data-theme='light'] & {
        @content;
    }

    @media (prefers-color-scheme: light) {
        :root:not([data-theme='dark']) & {
            @content;
        }
    }
}

// ============================================================================
// PRINT MIXINS
// ============================================================================

/// Apply styles only for print
@mixin print-only {
    @media print {
        @content;
    }
}

/// Hide element in print
@mixin print-hide {
    @media print {
        // stylelint-disable-next-line no-invalid-position-declaration -- Valid in print context
        display: none;
    }
}